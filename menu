#!/bin/bash

RED="\e[31m"
GREEN="\e[32m"
YELLOW="\e[33m"
BLUE="\e[34m"
CYAN="\e[36m"
ENDCOLOR="\e[0m"

pub_ip=$(wget -qO- https://ipecho.net/plain ; echo)

old_db_port=$(grep "DROPBEAR_PORT=" /etc/default/dropbear | sed 's/=/= /'  | awk '{print$2}')

old_db_ssl=$(grep "accept =" /etc/stunnel/stunnel.conf | sed ':a;N;$!ba;s/\n/ /g' | sed 's/accept =//g' | awk '{print$1}')

old_op_ssl=$(grep "accept =" /etc/stunnel/stunnel.conf | sed ':a;N;$!ba;s/\n/ /g' | sed 's/accept =//g' | awk '{print$2}')

old_squid_port=$(sed /^#/d /etc/squid/squid.conf | grep "http_port" | awk '{print$2}')

old_udpgw_port=$(cat /etc/systemd/system/udpgw.service | sed 's/ /\n/g'  | grep "127.0.0.1:" | sed 's/:/ /' | awk '{print$2}')

if ! [ $(id -u) = 0 ]; then
   echo -e "${RED}Plese run the command with root privilages!${ENDCOLOR}"
   exit 1
fi
 
clear

echo -e "\033[0;34mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\033[0m"
echo -e "\E[44;1;37m      ğŸ’ğƒğ€ğ“ğ€ğŠğˆğğ†ğƒğğŒ-ğ€ğ”ğ“ğ-ğ’ğ’ğ‡-ğ’ğ‚ğ‘ğˆğğ“ğŸ’\E[0m"
echo -e "\033[0;34mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\033[0m"
echo "" 
echo -e "${RED} ğŸ›‘ ğš‚ğ™²ğšğ™¸ğ™¿ğšƒ ğ™±ğšˆâš¡ï¸DATA-KING-OFFCIALâš¡ï¸\n"                                    
echo -e "${GREEN} ğŸ›‘ ğš„ğ™¿ğ™³ğ™°ğšƒğ™´ ğš…ğ™´ğšğš‚ğ™¸ğ™¾ğ™½ - 1\n"
echo -e "${BLUE} ğŸ›‘ Telegram - @Dk_king_offcial\n"   
echo -e "${YELLOW} ğŸ›‘ Whatsapp - wa.me/+94768100942\n"          
echo -e "${RED}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n"
echo -e "${YELLOW}------------------ â­ï¸Server Detailsâ­ï¸ ----------------------\n"
echo -e "${GREEN}â­ï¸YOUR SERVER IP ADDRESS : $pub_ip"
echo -e "â­ï¸Dropbear port : $old_db_port"
echo -e "â­ï¸SSL port : $old_db_ssl"
echo -e "â­ï¸Openssh +  SSL port : $old_op_ssl"
echo -e "â­ï¸Squid port : $old_squid_port"
echo -e "â­ï¸BadVPN  port : $old_udpgw_port\n"
echo -e "${RED}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n"
echo -e "${CYAN}ğŸ“Œ1)ğŸš¥Add new users"
echo -e "ğŸ“Œ2)ğŸš¥View All users"
echo -e "ğŸ“Œ3)ğŸš¥Edit an existing user"
echo -e "ğŸ“Œ4)ğŸš¥Delete a user"
echo -e "ğŸ“Œ5)ğŸš¥Change Ports"
echo -e "ğŸ“Œ6)ğŸš¥Edit SSH Banner"
echo -e "ğŸ“Œ7)ğŸš¥Server Information"
echo -e "ğŸ“Œ8)ğŸš¥Server Speedtest"
echo -e "ğŸ“Œ9)ğŸš¥Remove Script"
echo -e "ğŸ“Œ10)ğŸš¥Exit"
echo -e "${RED}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n"
echo -e "${YELLOW}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â€¢á´…á´€á´›á´€á´‹ÉªÉ´É¢á´…á´á´ á´˜Ê€á´á´Šá´‡á´„á´›â€¢â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n"

case $n in
  1) /etc/elhssh-v2/UserManager.sh;;
  2) /etc/elhssh-v2/ListUsers.sh;;
  3) /etc/elhssh-v2/ChangeUser.sh;;
  4) /etc/elhssh-v2/DelUser.sh;;
  5) /etc/elhssh-v2/ChangePorts.sh;;
  6) /etc/elhssh-v2/Banner.sh;;
  7) clear && screenfetch -p || echo -e "${RED}Screenfetch not installed. please install${ENDCOLOR}"; echo -e "\nPress Enter to return back to the menu";read;menu;;  
  8) clear && python3 /etc/elhssh-v2/speedtest-cli || echo -e "${RED}Python3 or speedtest-cli not installed. please install${ENDCOLOR}"; echo -e "\nPress Enter to return back to the menu";read;menu;;
  9) /etc/elhssh-v2/RemoveScript.sh;;
  10) clear;exit;;
  *) echo -e "${RED}\nInvalid Option. Press Enter to return back to the menu${ENDCOLOR}";read && menu;;
esac
